<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Grow a Garden Tycoon</title>
  <style>
    body { font-family: sans-serif; background: #cfe; text-align: center; }
    #game { display: grid; grid-template-rows: repeat(10, 40px); grid-template-columns: repeat(10, 40px); width: 400px; margin: 20px auto; }
    .tile {
      width: 40px;
      height: 40px;
      border: 1px solid #888;
      box-sizing: border-box;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .player { background: blue; color: white; font-weight: bold; }
    .seed-merchant { background: yellow; }
    .sell-merchant { background: gold; }
    .garden { background: brown; }
    .planted { background: green; }
    .ready { background: orange; }
  </style>
</head>
<body>

<h2>🌱 Grow-a-Garden Tycoon</h2>
<p>Coins: <span id="coins">20</span> | Inventory: <span id="inventory">0</span> | Restock in: <span id="restock-timer">120</span>s</p>

<div id="game"></div>

<script>
  const gameEl = document.getElementById("game");
  const coinsEl = document.getElementById("coins");
  const inventoryEl = document.getElementById("inventory");
  const restockTimerEl = document.getElementById("restock-timer");

  const width = 10;
  const height = 10;
  const map = [];

  let player = { x: 4, y: 9 };
  let coins = 20;
  let inventory = 0;
  let garden = [];

  const SEED_PRICE = 5;
  let seedShopAvailable = true;
  let countdown = 120;

  // Setup map with types
  for (let y = 0; y < height; y++) {
    map[y] = [];
    for (let x = 0; x < width; x++) {
      if (y === 0 && x === 2) map[y][x] = "seed-merchant";
      else if (y === 0 && x === 7) map[y][x] = "sell-merchant";
      else if (y >= 3 && y <= 6 && x >= 3 && x <= 6) {
        map[y][x] = "garden";
        garden.push({ x, y, status: "empty", timer: 0 });
      } else map[y][x] = "empty";
    }
  }

  function draw() {
    gameEl.innerHTML = "";
    for (let y = 0; y < height; y++) {
      for (let x = 0; x < width; x++) {
        const tile = document.createElement("div");
        tile.className = "tile";

        const gardenTile = garden.find(g => g.x === x && g.y === y);
        if (gardenTile) {
          if (gardenTile.status === "planted") tile.classList.add("planted");
          if (gardenTile.status === "ready") tile.classList.add("ready");
          else tile.classList.add("garden");
        } else {
          tile.classList.add(map[y][x]);
        }

        if (player.x === x && player.y === y) {
          tile.textContent = "👨‍🌾";
          tile.classList.add("player");
        }

        gameEl.appendChild(tile);
      }
    }

    coinsEl.textContent = coins;
    inventoryEl.textContent = inventory;
  }

  function updateGardenGrowth() {
    garden.forEach(g => {
      if (g.status === "planted") {
        g.timer -= 1;
        if (g.timer <= 0) {
          g.status = "ready";
        }
      }
    });
  }

  function interact() {
    const tile = map[player.y][player.x];

    if (tile === "seed-merchant") {
      if (seedShopAvailable) {
        if (coins >= SEED_PRICE) {
          coins -= SEED_PRICE;
          inventory += 1;
          alert("Bought 1 seed!");
        } else {
          alert("Not enough coins!");
        }
      } else {
        alert("Shop is restocking...");
      }
    }

    if (tile === "sell-merchant") {
      let sold = 0;
      garden.forEach(g => {
        if (g.status === "ready") {
          g.status = "empty";
          g.timer = 0;
          sold += 1;
        }
      });
      if (sold > 0) {
        coins += sold * 10;
        alert("Sold " + sold + " crops for $" + (sold * 10));
      } else {
        alert("No ready crops to sell.");
      }
    }

    const gardenTile = garden.find(g => g.x === player.x && g.y === player.y);
    if (gardenTile) {
      if (gardenTile.status === "ready") {
        alert("Harvested a crop!");
        gardenTile.status = "empty";
        coins += 10;
      } else if (gardenTile.status === "empty" && inventory > 0) {
        gardenTile.status = "planted";
        gardenTile.timer = 10;
        inventory -= 1;
      }
    }

    draw();
  }

  document.addEventListener("keydown", (e) => {
    if (e.key === "ArrowUp" && player.y > 0) player.y--;
    if (e.key === "ArrowDown" && player.y < height - 1) player.y++;
    if (e.key === "ArrowLeft" && player.x > 0) player.x--;
    if (e.key === "ArrowRight" && player.x < width - 1) player.x++;
    if (e.key === " ") interact(); // spacebar to interact
    draw();
  });

  // Restock timer
  setInterval(() => {
    countdown--;
    if (countdown <= 0) {
      seedShopAvailable = true;
      countdown = 120;
    }
    restockTimerEl.textContent = countdown;
    updateGardenGrowth();
    draw();
  }, 1000);

  draw();
</script>

</body>
</html>
